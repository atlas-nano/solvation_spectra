colvarsRestartFrequency 200000
# colvarsTrajAppend  off

colvar {
    # coordination number between Li and O from WATER                     
    name              coord_Li_O
    width             0.1
    lowerBoundary     0.0
    hardLowerBoundary yes
    upperBoundary     7.0 

    # outputAppliedForce on

    # extendedLagrangian on
    # extendedFluctuation 0.01
    # extendedTemp 298

    coordNum {
        # componentCoeff 0.111 # normalization over 9 Li+
        group1 { atomNumbers 1501}
        group2 { atomNumbers 1 2 6 10 13 16 19 22 25 28 31 34 37 38 43 44 49 52 55 58 61 64 67 70 73 76 79 82 85 88 91 94 97 100 103 106 109 112 115 118 121 124 127 130 133 136 139 142 145 148 151 154 157 160 163 166 169 172 175 178 181 184 187 190 193 196 199 202 205 208 211 214 217 220 223 226 229 232 235 238 241 244 247 250 253 256 259 262 265 268 271 274 277 280 283 286 289 292 295 298 301 304 307 310 313 316 319 322 325 328 331 334 337 340 343 346 349 352 355 358 361 364 367 370 373 376 379 382 385 388 391 394 397 400 403 406 409 412 415 418 421 424 427 430 433 436 439 442 445 448 451 454 457 460 463 466 469 472 475 478 481 484 487 490 493 496 499 500 505 508 511 514 517 520 523 526 529 532 535 538 541 544 547 550 553 556 559 562 565 568 571 574 577 580 583 586 589 592 595 598 601 604 607 610 613 616 619 622 625 628 631 634 637 640 643 646 649 652 655 658 661 664 667 670 673 676 679 682 685 688 691 694 697 700 703 706 709 712 715 718 721 724 727 730 733 736 739 742 745 748 751 754 757 760 763 766 769 772 775 778 781 784 787 790 793 796 799 802 805 808 811 814 817 820 823 826 829 832 835 838 841 844 847 850 853 856 859 862 865 868 871 874 877 880 883 886 889 892 895 898 901 904 907 910 913 916 919 922 925 928 931 934 937 940 943 946 949 952 955 958 961 964 967 970 973 976 979 982 985 988 991 994 997 1000 1003 1006 1009 1012 1015 1018 1021 1024 1027 1030 1033 1036 1039 1042 1045 1048 1051 1054 1057 1060 1063 1066 1069 1072 1075 1078 1081 1084 1087 1090 1093 1096 1099 1102 1105 1108 1111 1114 1117 1120 1123 1126 1129 1132 1135 1138 1141 1144 1147 1150 1153 1156 1159 1162 1165 1168 1171 1174 1177 1180 1183 1186 1189 1192 1195 1198 1201 1204 1207 1210 1213 1216 1219 1222 1225 1228 1231 1234 1237 1240 1243 1246 1249 1252 1255 1258 1261 1264 1267 1270 1273 1276 1279 1282 1285 1288 1291 1294 1297 1300 1303 1306 1309 1312 1315 1318 1321 1324 1327 1330 1333 1336 1339 1342 1345 1348 1351 1354 1357 1360 1363 1366 1369 1372 1375 1378 1381 1384 1387 1390 1393 1396 1399 1402 1405 1408 1411 1414 1417 1420 1423 1426 1429 1432 1435 1438 1441 1444 1447 1450 1453 1456 1459 1462 1465 1468 1471 1474 1477 1480 1483 1486 1489 1492 1495 1498} 
        # Li-O  r0 cutoff
        cutoff 2.65 
        # numNumer 48
        # numDenom 96
        }
}

colvar {
    # coordination number between Li and Cl from WATER                     
    name              coord_Li_Cl
    width             0.1
    lowerBoundary     0.0
    hardLowerBoundary yes
    upperBoundary     7.0 

    # outputAppliedForce on

    # extendedLagrangian on
    # extendedFluctuation 0.01
    # extendedTemp 298

    coordNum {
        # componentCoeff 0.111 # normalization over 9 Li+
        group1 { atomNumbers 1501}
        group2 { atomNumbers 1502 1504 1506 1508 1510 1512 1514 1516 1518 1520 1522 1524 1526 1528 1530 1532 1534 1536 1538 1540 1542 1544 1546 1548 1550 1552 1554 1556 1558 1560 1562 1564 1566 1568 1570 1572 1574 1576 1578 1580 1582 1584 1586 1588 1590 1592 1594 1596 1598 1600 1602 1604 1606 1608 1610 1612 1614 1616 1618 1620 1622 1624 1626 1628 1630 1632 1634 1636 1638 1640 1642 1644 1646 1648 1650 1652 1654 1656 1658 1660 1662 1664 1666 1668 1670 1672 1674 1676 1678 1680} 
        # Li-Cl  r0 cutoff
        cutoff 3.05
        # numNumer 48
        # numDenom 96
        }
}

colvar {
    # coordination number between Li and Li from WATER                     
    name              coord_Li
    width             0.1
    lowerBoundary     0.0
    hardLowerBoundary yes
    upperBoundary     7.0 

    # outputAppliedForce on

    # extendedLagrangian on
    # extendedFluctuation 0.01
    # extendedTemp 298

    coordNum {
        # componentCoeff 0.111 # normalization over 9 Li+
        group1 { atomNumbers 1501}
        group2 { atomNumbers 1503 1505 1507 1509 1511 1513 1515 1517 1519 1521 1523 1525 1527 1529 1531 1533 1535 1537 1539 1541 1543 1545 1547 1549 1551 1553 1555 1557 1559 1561 1563 1565 1567 1569 1571 1573 1575 1577 1579 1581 1583 1585 1587 1589 1591 1593 1595 1597 1599 1601 1603 1605 1607 1609 1611 1613 1615 1617 1619 1621 1623 1625 1627 1629 1631 1633 1635 1637 1639 1641 1643 1645 1647 1649 1651 1653 1655 1657 1659 1661 1663 1665 1667 1669 1671 1673 1675 1677 1679} 
        # Li-O  r0 cutoff
        cutoff 5
        # numNumer 48
        # numDenom 96
        }
}

metadynamics {
    name metadyn_d1
    colvars coord_Li_O coord_Li_Cl coord_Li

    hillWeight       0.6 # gaussian height, sampling accuracy
    newHillFrequency 1000
    hillWidth        1.25 # gaussian width, 2sigma value

    useGrids   yes
#    rebinGrids yes

    outputEnergy on
    outputFreq 100000

    multipleReplicas on
    replicasRegistry /expanse/lustre/scratch/xiruan/temp_project/solvation_313K/meta_single_Li/10M/meta/multiple_replica.txt
    replicaUpdateFrequency 25000
    replicaID __REPID__

    # writeTIPMF yes
    writeFreeEnergyFile  yes
    # keepFreeEnergyFiles yes
    writeHillsTrajectory yes
    writePartialFreeEnergyFile yes
    
#    writeHillsTrajectory yes
}

